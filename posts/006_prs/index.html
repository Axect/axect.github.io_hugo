<!DOCTYPE html>
<html lang="kr">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Axect ">
<meta name="description" content="Differential energy spectrum of ALPs from primordial black hole (PBH)${}^{[1]}$
ëˆ„êµ°ê°€ ìœ„ì™€ ê°™ì´ ì •ê·œí™” ë˜ì§€ ì•Šì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ ê·¸ë˜í”„ë¥¼ ê°€ì ¸ì™”ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ê·¸ëŸ¬ê³ ì„œëŠ” ë‹¹ì‹ ì—ê²Œ ì´ëŸ¬í•œ í™•ë¥ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„° 10000ê°œë¥¼ ë§Œë“¤ì–´ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤ë©´, ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?
ì¼ë‹¨, ì„ì˜ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìƒ˜í”Œë§ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê°€ì¥ ì˜ ì•Œë ¤ì§„ ë°©ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒì˜ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.
Inverse Transform Sampling Rejection Sampling Inverse Transform Samplingì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜ë¥¼ êµ¬í•˜ê³ , ê·¸ ëˆ„ì ë¶„í¬í•¨ìˆ˜ì˜ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•œ ë’¤, ê·¸ ì—­í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ íš¨ìœ¨ì ì´ì§€ë§Œ, í™•ë¥ ë°€ë„í•¨ìˆ˜ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ê°–ëŠëƒì— ë”°ë¼ì„œ êµ¬í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì—, ì§€ê¸ˆì˜ ê²½ìš°ì²˜ëŸ¼ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ì •í™•í•œ ê¼´ì„ ëª¨ë¥¼ ë•ŒëŠ” ì‚¬ìš©í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤." />
<meta name="keywords" content=", statistics, piecewise rejection sampling" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://axect.github.io/posts/006_prs/" />


    <title>
        
            ğŸ“Š Piecewise Rejection Sampling :: Axect&#39;s Blog  â€” ìˆ˜í•™, ë¬¼ë¦¬ ê·¸ë¦¬ê³  ê³„ì‚°
        
    </title>






<link rel="stylesheet" href="https://axect.github.io/main.ca40a89d74cd83420f761ace3ade9979c068af610bbe3a1e92c19d4522d63715.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://axect.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://axect.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://axect.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://axect.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://axect.github.io/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://axect.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="ğŸ“Š Piecewise Rejection Sampling">
<meta itemprop="description" content="Differential energy spectrum of ALPs from primordial black hole (PBH)${}^{[1]}$
ëˆ„êµ°ê°€ ìœ„ì™€ ê°™ì´ ì •ê·œí™” ë˜ì§€ ì•Šì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ ê·¸ë˜í”„ë¥¼ ê°€ì ¸ì™”ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ê·¸ëŸ¬ê³ ì„œëŠ” ë‹¹ì‹ ì—ê²Œ ì´ëŸ¬í•œ í™•ë¥ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„° 10000ê°œë¥¼ ë§Œë“¤ì–´ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤ë©´, ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?
ì¼ë‹¨, ì„ì˜ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìƒ˜í”Œë§ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê°€ì¥ ì˜ ì•Œë ¤ì§„ ë°©ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒì˜ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.
Inverse Transform Sampling Rejection Sampling Inverse Transform Samplingì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜ë¥¼ êµ¬í•˜ê³ , ê·¸ ëˆ„ì ë¶„í¬í•¨ìˆ˜ì˜ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•œ ë’¤, ê·¸ ì—­í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ íš¨ìœ¨ì ì´ì§€ë§Œ, í™•ë¥ ë°€ë„í•¨ìˆ˜ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ê°–ëŠëƒì— ë”°ë¼ì„œ êµ¬í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì—, ì§€ê¸ˆì˜ ê²½ìš°ì²˜ëŸ¼ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ì •í™•í•œ ê¼´ì„ ëª¨ë¥¼ ë•ŒëŠ” ì‚¬ìš©í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤."><meta itemprop="datePublished" content="2022-11-18T17:49:04+09:00" />
<meta itemprop="dateModified" content="2022-11-18T17:49:04+09:00" />
<meta itemprop="wordCount" content="1877"><meta itemprop="image" content="https://axect.github.io"/>
<meta itemprop="keywords" content="statistics,piecewise rejection sampling," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://axect.github.io"/>

<meta name="twitter:title" content="ğŸ“Š Piecewise Rejection Sampling"/>
<meta name="twitter:description" content="Differential energy spectrum of ALPs from primordial black hole (PBH)${}^{[1]}$
ëˆ„êµ°ê°€ ìœ„ì™€ ê°™ì´ ì •ê·œí™” ë˜ì§€ ì•Šì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ ê·¸ë˜í”„ë¥¼ ê°€ì ¸ì™”ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ê·¸ëŸ¬ê³ ì„œëŠ” ë‹¹ì‹ ì—ê²Œ ì´ëŸ¬í•œ í™•ë¥ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„° 10000ê°œë¥¼ ë§Œë“¤ì–´ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤ë©´, ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?
ì¼ë‹¨, ì„ì˜ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìƒ˜í”Œë§ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê°€ì¥ ì˜ ì•Œë ¤ì§„ ë°©ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒì˜ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.
Inverse Transform Sampling Rejection Sampling Inverse Transform Samplingì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜ë¥¼ êµ¬í•˜ê³ , ê·¸ ëˆ„ì ë¶„í¬í•¨ìˆ˜ì˜ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•œ ë’¤, ê·¸ ì—­í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ íš¨ìœ¨ì ì´ì§€ë§Œ, í™•ë¥ ë°€ë„í•¨ìˆ˜ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ê°–ëŠëƒì— ë”°ë¼ì„œ êµ¬í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì—, ì§€ê¸ˆì˜ ê²½ìš°ì²˜ëŸ¼ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ì •í™•í•œ ê¼´ì„ ëª¨ë¥¼ ë•ŒëŠ” ì‚¬ìš©í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤."/>



    <meta property="og:title" content="ğŸ“Š Piecewise Rejection Sampling" />
<meta property="og:description" content="Differential energy spectrum of ALPs from primordial black hole (PBH)${}^{[1]}$
ëˆ„êµ°ê°€ ìœ„ì™€ ê°™ì´ ì •ê·œí™” ë˜ì§€ ì•Šì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ ê·¸ë˜í”„ë¥¼ ê°€ì ¸ì™”ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ê·¸ëŸ¬ê³ ì„œëŠ” ë‹¹ì‹ ì—ê²Œ ì´ëŸ¬í•œ í™•ë¥ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„° 10000ê°œë¥¼ ë§Œë“¤ì–´ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤ë©´, ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?
ì¼ë‹¨, ì„ì˜ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìƒ˜í”Œë§ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê°€ì¥ ì˜ ì•Œë ¤ì§„ ë°©ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒì˜ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.
Inverse Transform Sampling Rejection Sampling Inverse Transform Samplingì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜ë¥¼ êµ¬í•˜ê³ , ê·¸ ëˆ„ì ë¶„í¬í•¨ìˆ˜ì˜ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•œ ë’¤, ê·¸ ì—­í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ íš¨ìœ¨ì ì´ì§€ë§Œ, í™•ë¥ ë°€ë„í•¨ìˆ˜ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ê°–ëŠëƒì— ë”°ë¼ì„œ êµ¬í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì—, ì§€ê¸ˆì˜ ê²½ìš°ì²˜ëŸ¼ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ì •í™•í•œ ê¼´ì„ ëª¨ë¥¼ ë•ŒëŠ” ì‚¬ìš©í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://axect.github.io/posts/006_prs/" /><meta property="og:image" content="https://axect.github.io"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-18T17:49:04+09:00" />
<meta property="article:modified_time" content="2022-11-18T17:49:04+09:00" />






    <meta property="article:published_time" content="2022-11-18 17:49:04 &#43;0900 KST" />









    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://axect.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">cd /home/axect/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>



        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://axect.github.io/about">About</a></li><li><a href="https://axect.github.io/posts">Blog</a></li><li><a href="https://axect.github.io/tags">Tags</a></li>
        <div class="submenu">
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn"><span class="flag fi fi-kr"></span></a>
                <div class="dropdown-content">
                    
                        
                            <a title="en" href="https://axect.github.io/en/posts/006_prs/"><span class="flag fi fi-gb"></span></a>
                        
                    
                </div>
            </li>
        </div>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>

    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  },
  "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
  SVG: { linebreaks: { automatic: true } },
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-167590700-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        9 ë¶„

         | In English :
          
              <a href="https://axect.github.io/en/posts/006_prs/"><span class="flag fi fi-gb"></span></a>
          
        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://axect.github.io/posts/006_prs/">ğŸ“Š Piecewise Rejection Sampling</a>
      </h1>

      

      
        <hr />
        <aside id="toc">
          <div class="toc-title">ëª©ì°¨</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#1-rejection-sampling">1. Rejection Sampling</a></li>
    <li><a href="#2-piecewise-rejection-sampling">2. Piecewise Rejection Sampling</a>
      <ul>
        <li><a href="#21-max-pooling">2.1. Max-Pooling</a></li>
        <li><a href="#22-weighted-uniform-distribution">2.2. Weighted Uniform Distribution</a></li>
        <li><a href="#23-piecewise-rejection-sampling">2.3. Piecewise Rejection Sampling</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
    <li><a href="#footnotes">A. Footnotes</a></li>
  </ul>
</nav>
        </aside>
        <hr />

      

      <div class="post-content">
        <figure>
    <img src="https://axect.github.io/posts/images/006_01_test_dist.png"
         alt="Differential energy spectrum of ALPs from primordial black hole (PBH)${}^{[1]}$"/> <figcaption style="text-align:center">
            <p>Differential energy spectrum of ALPs from primordial black hole (PBH)<a href="#footnotes">${}^{[1]}$</a></p>
        </figcaption>
</figure>
<p>â€ƒâ€ƒëˆ„êµ°ê°€ ìœ„ì™€ ê°™ì´ ì •ê·œí™” ë˜ì§€ ì•Šì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ ê·¸ë˜í”„ë¥¼ ê°€ì ¸ì™”ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.
ê·¸ëŸ¬ê³ ì„œëŠ” ë‹¹ì‹ ì—ê²Œ ì´ëŸ¬í•œ í™•ë¥ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„° 10000ê°œë¥¼ ë§Œë“¤ì–´ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤ë©´, ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?</p>
<p>ì¼ë‹¨, ì„ì˜ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìƒ˜í”Œë§ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê°€ì¥ ì˜ ì•Œë ¤ì§„ ë°©ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒì˜ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Inverse_transform_sampling">Inverse Transform Sampling</a></li>
<li><a href="https://en.wikipedia.org/wiki/Rejection_sampling">Rejection Sampling</a></li>
</ol>
<p>Inverse Transform Samplingì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜ë¥¼ êµ¬í•˜ê³ , ê·¸ ëˆ„ì ë¶„í¬í•¨ìˆ˜ì˜ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•œ ë’¤, ê·¸ ì—­í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ íš¨ìœ¨ì ì´ì§€ë§Œ, í™•ë¥ ë°€ë„í•¨ìˆ˜ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ê°–ëŠëƒì— ë”°ë¼ì„œ êµ¬í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì—, ì§€ê¸ˆì˜ ê²½ìš°ì²˜ëŸ¼ í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ ì •í™•í•œ ê¼´ì„ ëª¨ë¥¼ ë•ŒëŠ” ì‚¬ìš©í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤.<a href="#footnotes">${}^{[2]}$</a> ê·¸ëŸ¬ë‚˜, Rejection Samplingì€ í™•ë¥ ë°€ë„í•¨ìˆ˜ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ê°–ëŠëƒì— ìƒê´€ì—†ì´ ì ìš©í•  ìˆ˜ ìˆëŠ”ë°, ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì´ ë°©ë²•ìœ¼ë¡œ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="1-rejection-sampling">1. Rejection Sampling</h2>
<p>â€ƒâ€ƒ<span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Rejection sampling </b>
</span>(í˜¹ì€ Acceptance-rejection method)ì˜ ì•Œê³ ë¦¬ì¦˜ì€ ë§¤ìš° ê°„ë‹¨í•œ í¸ì…ë‹ˆë‹¤. ì´ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ì €í¬ê°€ samplingí•˜ê³  ì‹¶ì€ í™•ë¥ ë¶„í¬ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¥¼ $f(x)$ë¼ ëª…ëª…í•˜ê² ìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” $f(x)$ë¡œë¶€í„° ë°”ë¡œ samplingí•˜ëŠ” ë°©ë²•ì„ ëª¨ë¥´ë¯€ë¡œ sampling í•  ìˆ˜ ìˆëŠ” í™•ë¥ ë°€ë„í•¨ìˆ˜ì¸ $g(x)$ë¥¼ ë„ì…í•©ë‹ˆë‹¤. ì´ë•Œ, $g(x)$ëŠ” íŠ¹ì •í•œ ì–‘ì˜ ìƒìˆ˜ $M$ì— ëŒ€í•˜ì—¬ ì •ì˜ì—­ì˜ ëª¨ë“  $x$ì— ëŒ€í•˜ì—¬ $f(x) \leq M \cdot g(x)$ ì¡°ê±´ì´ ì„±ë¦½í•´ì•¼í•©ë‹ˆë‹¤. ì´ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<figure>
    <img src="https://axect.github.io/posts/images/006_02_rejection.svg"
         alt="ì…ìë¬¼ë¦¬ì—ì„œ ìì£¼ ë³¼ ìˆ˜ ìˆëŠ” ê·¸ë˜í”„" width="80%" class="center"/> <figcaption style="text-align:center">
            <p>ì…ìë¬¼ë¦¬ì—ì„œ ìì£¼ ë³¼ ìˆ˜ ìˆëŠ” ê·¸ë˜í”„</p>
        </figcaption>
</figure>
<p>ë³´í†µ samplingí•˜ê¸° ê°€ì¥ ì‰¬ìš´ í™•ë¥ ë¶„í¬ëŠ” Uniform distribution(ê· ë“±ë¶„í¬)ì´ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” $g(x)=\text{Unif}(x|0,10)$ìœ¼ë¡œ ì •ì˜í•˜ì˜€ìŠµë‹ˆë‹¤. ë˜í•œ $f(x)$ì˜ ìµœëŒ“ê°’ì´ 1ì´ë¯€ë¡œ $M=10$ìœ¼ë¡œ ì •í•˜ì—¬ $M\times g(x)$ê°€ í•­ìƒ $f(x)$ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìŒì„ ë³´ì¥í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ì œ ì´ ê·¸ë˜í”„ë¥¼ ì´ìš©í•˜ì—¬ samplingí•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>
<ol>
<li>
<p>$y$ë¥¼ $g(x)$ë¡œ ë¶€í„° samplingí•©ë‹ˆë‹¤. ì´ ê²½ìš°ì—” $y$ëŠ” $\text{Unif}(x|0,10)$ë¡œë¶€í„° samplingëœ ê°’ì´ ë©ë‹ˆë‹¤.</p>
</li>
<li>
<p>ê·¸ë ‡ê²Œ ì¶”ì¶œëœ $y$ì— ëŒ€í•˜ì—¬ ë˜ ë‹¤ë¥¸ ê· ë“±ë¶„í¬ì¸ $\text{Unif}(u|0,M\times g(y))$ë¡œë¶€í„° $u$ë¥¼ samplingí•©ë‹ˆë‹¤. (ì´ëŠ” $g(x)$ì˜ í˜•íƒœì™€ ë³„ê°œë¡œ í•­ìƒ ê· ë“±ë¶„í¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.)</p>
</li>
<li>
<p>ë§Œì•½ $u \leq f(y)$ì´ë©´ $y$ë¥¼ ìš°ë¦¬ê°€ samplingí•˜ê³ ì í•˜ëŠ” í™•ë¥ ë¶„í¬ $f(x)$ë¡œë¶€í„° samplingëœ ê°’ìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ 1ë²ˆìœ¼ë¡œ ëŒì•„ê°€ì„œ $y$ë¥¼ samplingí•©ë‹ˆë‹¤.</p>
</li>
</ol>
<p>ì´ sampling ë°©ë²•ì´ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Rejection sampling(ê¸°ê° ìƒ˜í”Œë§)</b>
</span>ì…ë‹ˆë‹¤. 3ë²ˆì—ì„œ ë³´ë‹¤ì‹œí”¼ $u$ê°€ $f(y)$ë³´ë‹¤ í¬ë‹¤ë©´ ê¸°ê°í•˜ê¸° ë•Œë¬¸ì— ë¶™ì—¬ì§„ ì´ë¦„ì…ë‹ˆë‹¤. ì´ ê°„ë‹¨í•œ ì•Œê³ ë¦¬ì¦˜ ë§Œìœ¼ë¡œ ì™„ì „íˆ ìƒˆë¡œìš´ í™•ë¥ ë¶„í¬ì¸ $f(x)$ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ê·¼ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ëˆ„ì í™•ë¥ ë¶„í¬í•¨ìˆ˜(CDF)ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p>í™•ë¥ ë³€ìˆ˜ $X$ë¥¼ Rejection samplingìœ¼ë¡œ ì–»ì–´ì§„ í™•ë¥ ë³€ìˆ˜ë¼ í•˜ë©´, ë‹¤ë¥¸ ë‘ í™•ë¥ ë³€ìˆ˜ $Y \sim g(y)$, $U \sim \text{Unif}(u|0, M\cdot g(y))$ì— ëŒ€í•˜ì—¬  ë‹¤ìŒê³¼ ê°™ì€ ê´€ê³„ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
$$
P(X \leq x) = P\left(Y \leq x \,|\, U &lt; f(Y)\right)
$$
ìš°ë³€ì˜ ì¡°ê±´ë¶€ í™•ë¥ ì€ $U$ê°€ ê¸°ê°ë˜ì§€ ì•Šì•˜ì„ ë•Œ, $Y$ê°€ $x$ë³´ë‹¤ ì‘ì„ í™•ë¥ ì´ë©° ì´ëŠ” ìœ„ì˜ ì•Œê³ ë¦¬ì¦˜ì—ì„œ 3ë²ˆê³¼ ê°™ìŠµë‹ˆë‹¤.
ì´ë¥¼ ì¡°ê±´ë¶€ í™•ë¥ ì˜ ì •ì˜ë¥¼ ì´ìš©í•˜ì—¬ ë³€í˜•í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
$$
P(X \leq x) = \frac{P (Y \leq x,~U &lt; f(Y))}{P(U &lt; f(Y))}
$$
ë¨¼ì € ìœ„ ì‹ì˜ ë¶„ìë¥¼ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì „ê°œí•´ë³´ê² ìŠµë‹ˆë‹¤.
$$
\begin{aligned}
P(Y \leq x,U &lt; f(Y)) &amp;= \int P(Y \leq x,U &lt; f(Y) | Y = y) \cdot g(y) \,dy \\
&amp;= \int P(y \leq x,~U &lt; f(y)) \cdot g(y) \,dy \\
&amp;= \int ğŸ™_{y \leq x} \cdot P(U &lt; f(y))\cdot  g(y) \, dy \\
&amp;= \int_{-\infty}^x P(U &lt; f(y)) \cdot g(y) \, dy
\end{aligned}
$$
2ë²ˆì§¸ ì‹ì—ì„œ 3ë²ˆì§¸ë¡œ ë„˜ì–´ê°ˆë•ŒëŠ” $y \leq x$ì™€ $U &lt; f(y)$ëŠ” ë…ë¦½ì´ë¼ëŠ” ì¡°ê±´ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ì œ $U \sim \text{Unif}(u|0,\,M\cdot g(y))$ì´ë¯€ë¡œ $\displaystyle P(U &lt; f(y)) = \frac{1}{M\cdot g(y)} \times (f(y) - 0)$ì„ ëŒ€ì…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
$$
\begin{aligned}
P(Y \leq x,~U &lt; f(Y)) &amp;= \int_{-\infty}^x \frac{f(y)}{M\cdot g(y)}\cdot g(y) \, dy \\
&amp;= \frac{1}{M} \int_{-\infty}^x f(y) \, dy
\end{aligned}
$$
<!-- raw HTML omitted -->
ì´ì œ ë¶„ëª¨ë¥¼ êµ¬í•´ë³´ê² ìŠµë‹ˆë‹¤.
$$
\begin{aligned}
P(U &lt; f(Y)) &amp;= \int P(U &lt; f(y)) \cdot g(y) \, dy \\
&amp;= \int \frac{f(y)}{M\cdot g(y)} \cdot g(y) \, dy \\
&amp;= \frac{1}{M} \int f(y) \, dy \\
&amp;= \frac{1}{M}
\end{aligned}
$$
ë§ˆì§€ë§‰ìœ¼ë¡œ ë¶„ìì™€ ë¶„ëª¨ë¥¼ ë‚˜ëˆ„ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
$$
P(X \leq x) = \int_{-\infty}^x f(y) \, dy
$$
ì´ëŠ” $f(x)$ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜ì™€ ê°™ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Rejection samplingìœ¼ë¡œ ì–»ì–´ì§„ í™•ë¥ ë³€ìˆ˜ $X$ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ëŠ” $f(x)$ë¼ëŠ” ê²ƒì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<p>ì´ì œ ìˆ˜í•™ì ìœ¼ë¡œ ì¦ëª…ì„ ë§ˆì³¤ìœ¼ë‹ˆ, ì´ë²ˆì—ëŠ” ì´ê²ƒì´ ì‹¤ì œë¡œ ì˜ ì‘ë™í•˜ëŠ”ì§€ ì½”ë“œë¥¼ ì‘ì„±í•´ë´…ì‹œë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">// Rust
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">use</span> peroxide::fuga::<span style="color:#f92672">*</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> M: <span style="color:#66d9ef">f64</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10.0</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> N: <span style="color:#66d9ef">usize</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">100_000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create g(x)=Unif(x|0,10) &amp; h(y)=Unif(y|0,M)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> g <span style="color:#f92672">=</span> Uniform(<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">10.0</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> h <span style="color:#f92672">=</span> Uniform(<span style="color:#ae81ff">0.0</span>, M);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Rejection sampling
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> x_vec <span style="color:#f92672">=</span> vec![<span style="color:#ae81ff">0</span><span style="color:#66d9ef">f64</span>; N];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#66d9ef">usize</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> N {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> x <span style="color:#f92672">=</span> g.sample(<span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> y <span style="color:#f92672">=</span> h.sample(<span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> y <span style="color:#f92672">&lt;=</span> f(x) {      <span style="color:#75715e">// Accept
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            x_vec[i] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {            <span style="color:#75715e">// Reject
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Test function
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">f</span>(x: <span style="color:#66d9ef">f64</span>) -&gt; <span style="color:#66d9ef">f64</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span><span style="color:#66d9ef">f64</span> <span style="color:#f92672">/</span> (x<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#66d9ef">f64</span>).sqrt() <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.2</span> <span style="color:#f92672">*</span> (<span style="color:#f92672">-</span>(x<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#66d9ef">f64</span>).powi(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">0.2</span>).exp()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ì•Œê³ ë¦¬ì¦˜ ìì²´ê°€ ê°„ë‹¨í•˜ë¯€ë¡œ ì½”ë“œ ì—­ì‹œ êµ‰ì¥íˆ ê°„ë‹¨í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ëŸ¼ì—ë„ ê²°ê³¼ëŠ” ë›°ì–´ë‚©ë‹ˆë‹¤.</p>
<figure>
    <img src="https://axect.github.io/posts/images/006_03_hist.png"
         alt="Result of rejection sampling" width="80%" class="center"/> <figcaption style="text-align:center">
            <p>Result of rejection sampling</p>
        </figcaption>
</figure>
<p>í™•ë¥ ë°€ë„í•¨ìˆ˜ì˜ í˜•íƒœì— êµ¬ì• ë°›ì§€ ì•Šìœ¼ë©° êµ¬í˜„ê¹Œì§€ ì‰¬ìš´ Rejection samplingì´ì§€ë§Œ ì¹˜ëª…ì ì¸ ë‹¨ì  ì—­ì‹œ ì¡´ì¬í•©ë‹ˆë‹¤. ë°”ë¡œ ê³„ì‚° íš¨ìœ¨ì´ êµ‰ì¥íˆ ë–¨ì–´ì§„ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. Rejection samplingì—ì„œ sampleì„ í™•ë³´í•˜ë ¤ë©´ ê¸°ê° ì¡°ê±´ì—ì„œ ì‚´ì•„ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ì¦‰, $P(U &lt; f(Y))$ê°€ ë†’ì„ ìˆ˜ë¡ ë¹ ë¥´ê²Œ sampleì„ í™•ë³´í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ê³  ë°˜ëŒ€ë¡œ ë‚®ì„ ìˆ˜ë¡ ì¶©ë¶„í•œ ìˆ˜ì˜ sampleì„ í™•ë³´í•˜ê¸°ê¹Œì§€ ì˜¤ë˜ ê±¸ë¦°ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Acceptance rate</b>
</span>(ìŠ¹ì¸ ë¹„ìœ¨)ë¼ê³  í•˜ë©° ì´ëŠ” ì´ë¯¸ ìœ„ì˜ ì¦ëª…ì—ì„œ ê³„ì‚°í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
<div class="notepaper">
    <br/>
    <span><b>Acceptance rate</b></span>
    <figure class="quote">
        <span class="curly-quotes">
            Rejectionì˜ Acceptace rateëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤.
$$
P(U &lt; f(Y)) = \int P(U &lt; f(y)) \cdot g(y) \, dy
$$
        </span>
    </figure>
</div>
<p>ì €í¬ê°€ ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ì—ì„œëŠ” ì´ëŠ” $1/M$ê³¼ ê°™ê³ , ì´ëŠ” $f(x)$ê°€ ì°¨ì§€í•˜ëŠ” ë„“ì´ë¥¼ $M \cdot g(x)$ê°€ ì°¨ì§€í•˜ëŠ” ì „ì²´ ë„“ì´ë¡œ ë‚˜ëˆˆ ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë¶„í¬ê°„ì˜ ì°¨ì´ê°€ í¬ë©´ í´ìˆ˜ë¡ Acceptance rateê°€ ë‚®ì•„ì§€ê³  ê·¸ë§Œí¼ sampleì„ í™•ë³´í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.
ê·¸ë‚˜ë§ˆ ì €í¬ê°€ ì‚¬ìš©í•œ ì˜ˆì‹œëŠ” $g(x)$ì™€ $f(x)$ì˜ ì°¨ì´ê°€ í° ë¶€ë¶„ì´ ë§ì§€ ì•Šì•„ì„œ ë¹„êµì  ê´œì°®ìŠµë‹ˆë‹¤ë§Œ, ì‹œì‘í•  ë•Œ ì œì‹œí•˜ì˜€ë˜ í™•ë¥ ë¶„í¬ì²˜ëŸ¼ 0ì¸ ë¶€ë¶„ì´ ë§ì€ ê²½ìš°ì—ëŠ” $g(x)$ë¡œ Uniform distributionì„ ì‚¬ìš©í•œë‹¤ë©´ ëŒ€ë¶€ë¶„ ê¸°ê°ë˜ì–´ë²„ë¦¬ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦´ë¿ë”ëŸ¬ ê±°ì˜ 0 ê·¼ì²˜ì˜ tailì— ëŒ€í•´ì„œëŠ” samplingì´ ë¶ˆê°€ëŠ¥í•œ ì§€ê²½ì—ê¹Œì§€ ì´ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>
<hr>
<h2 id="2-piecewise-rejection-sampling">2. Piecewise Rejection Sampling</h2>
<p>â€ƒâ€ƒì‚¬ì‹¤ ì´ë¯¸ ì—°êµ¬ìë“¤ì€ ì´ëŸ° ê²½ìš°ë¥¼ ìœ„í•´ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì„ ê³ ì•ˆí•´ë‘ì—ˆìŠµë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Adaptive Rejection Sampling (ARS)</b>
</span>ì™€ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Adaptive Rejection Metropolis Sampling (ARMS)</b>
</span>ê°€ ìˆìŠµë‹ˆë‹¤.
ì „ìì˜ ê²½ìš°ëŠ” íš¨ìœ¨ì ì´ì§€ë§Œ í•¨ìˆ˜ê°€ ë°˜ë“œì‹œ ë¡œê·¸-ì˜¤ëª©(log-concave)í•˜ë‹¤ëŠ” ë³´ì¥ì´ ìˆì–´ì•¼ í•˜ê³  í›„ìì˜ ê²½ìš°ëŠ” ì´ë¥¼ í•´ê²°í•˜ì—¬ ì¼ë°˜í™”í–ˆì§€ë§Œ êµ¬í˜„ì´ ìƒë‹¹íˆ ì–´ë µìŠµë‹ˆë‹¤. ë¬¼ë¡  ì´ë¯¸ ì˜ ë§Œë“¤ì–´ì§„ <a href="https://cran.r-project.org/web/packages/armspp/vignettes/arms.html">R package</a> ë“±ì´ ìˆìœ¼ë‹ˆ ì‚¬ìš©í•˜ëŠ” ê²ƒ ìì²´ëŠ” ì–´ë µì§€ ì•ŠìŠµë‹ˆë‹¤ë§Œ, ì—¬ê¸°ì„œëŠ” ë” ê°„ë‹¨í•œ ë°©ë²•ì„ ì†Œê°œí•˜ê³ ì í•©ë‹ˆë‹¤. ë°”ë¡œ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Piecewise Rejection Sampling (PRS)</b>
</span>ì…ë‹ˆë‹¤. ì´ëŠ” ì œê°€ ë¬¼ë¦¬í•™ ì—°êµ¬ë¥¼ ìˆ˜í–‰í•˜ë˜ ì¤‘ì— ì²˜ìŒì— ì œì‹œí•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ë§Œë“  ë°©ë²•ìœ¼ë¡œ, ê¸°ë³¸ì ì¸ í† ëŒ€ëŠ” Rejection samplingê³¼ ê°™ì§€ë§Œ $g(x)$ë¥¼ ë‹¨ìˆœí•œ Uniform distributionì´ ì•„ë‹Œ $f(x)$ì— ìµœì í™”ëœ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Weighted uniform distribution</b>
</span> (ê°€ì¤‘ê· ë“±ë¶„í¬)ë¡œ ìƒì •í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ ì°¨ê·¼ì°¨ê·¼ ì„¤ëª…í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<h3 id="21-max-pooling">2.1. Max-Pooling</h3>
<p>â€ƒâ€ƒì•„ë§ˆ ë”¥ëŸ¬ë‹ì— ê´€ì‹¬ìˆëŠ” ì‚¬ëŒì´ë¼ë©´ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Max Pooling</b>
</span>ì´ë¼ëŠ” ê°œë…ì„ ìµíˆ ë“¤ì–´ë´¤ì„ê²ë‹ˆë‹¤. CNNì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” Max poolingì€ ì‚¬ì‹¤ ê°œë…ì€ êµ‰ì¥íˆ ê°„ë‹¨í•©ë‹ˆë‹¤. ì¼ë‹¨ Max poolingì˜ ìˆ˜í•™ì  ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="notepaper">
    <br/>
    <span><b>Max pooling</b></span>
    <figure class="quote">
        <span class="curly-quotes">
            <p>Let $f\,:\,[a,b]\to \mathbb{R}$ be a continuous function and consider the equidistant partition of the interval $[a,b]$
$$
a = x_0 &lt; x_1 &lt; \cdots &lt; x_{n-1} &lt; x_n = b
$$
The partitions size, $(b-a)/n$ is called <em>stride</em>. Denote by $\displaystyle M_i = \max_{[x_{i-1},x_i]}f(x)$ and consider
the simple function</p>
<p>$$
S_n(x) = \sum_{i=1}^n M_i ğŸ™_{[x_{i-1},x_i)}(x).
$$</p>
<p>The process of approximating the function $f(x)$ by the simple function $S_n(x)$ is called <em>max-pooling</em>.</p>

        </span>
    </figure>
</div>
<p>ì—¬ê¸°ì„œ ì‚¬ìš©í•œ simple functionì´ë€ ì¸¡ë„ë¡ (Measure theory)ì—ì„œ ë“±ì¥í•˜ëŠ” í•¨ìˆ˜ë¡œ ê° êµ¬ê°„ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ìƒìˆ˜ë¥¼ ê°€ì§€ëŠ” í•¨ìˆ˜ë¥¼ ë§í•©ë‹ˆë‹¤. ìì„¸í•œ ì •ì˜ëŠ” <a href="https://axect.github.io/ML_with_Rust/measuretheory.html">Precise Machine Learning with Rust</a>ì˜ Definition 10ê³¼ Property 1ì„ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p>ê²°êµ­ Max-poolingì´ë€ ê°„ë‹¨íˆ ë§í•´ $f(x)$ë¥¼ $n$ê°œì˜ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ê³  ê° êµ¬ê°„ì—ì„œ $f(x)$ì˜ ìµœëŒ€ê°’ì„ êµ¬í•˜ì—¬ ì´ë¥¼ ê° êµ¬ê°„ì—ì„œì˜ ëŒ€í‘¯ê°’(Representative value)ìœ¼ë¡œ ê°–ëŠ” simple functionì„ êµ¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ì²˜ìŒ ì œì‹œí•œ ë¶„í¬ì— ëŒ€í•´ ì ìš©í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<figure>
    <img src="https://axect.github.io/posts/images/006_04_prs.svg"
         alt="Max-pooling for Test Distribution" width="90%" class="center"/> <figcaption style="text-align:center">
            <p>Max-pooling for Test Distribution</p>
        </figcaption>
</figure>
<p>ê·¸ë¦¼ì˜ ë¹¨ê°„ìƒ‰ ì‹¤ì„ ì„ $f(x)$ë¼ í•˜ë©´ íŒŒë€ìƒ‰ ì ì„ ì€ $f(x)$ë¥¼ max-poolingí•œ ê²°ê³¼ì…ë‹ˆë‹¤. ì´ì¯¤ë˜ë©´ ì´ë¯¸ ëˆˆì¹˜ì±ˆ ë¶„ë“¤ë„ ìˆì„í…ë°, ì €í¬ëŠ” ì´ íŒŒë€ìƒ‰ ì ì„ ì„ Rejection samplingì—ì„œì˜ $M\cdot g(x)$ë¡œ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” ê° êµ¬ê°„ë³„ë¡œëŠ” ê· ë“±ë¶„í¬ì˜ í˜•íƒœë¥¼ ê°–ì§€ë§Œ ê°ê° ë‹¤ë¥¸ ëŒ€í‘¯ê°’ì„ ê°–ëŠ” í™•ë¥ ë¶„í¬ë¥¼ ì •ì˜í•  ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Weighted uniform distribution</b>
</span>(ê°€ì¤‘ê· ë“±ë¶„í¬)ì…ë‹ˆë‹¤.</p>
<h3 id="22-weighted-uniform-distribution">2.2. Weighted Uniform Distribution</h3>
<div class="notepaper">
    <br/>
    <span><b>Weighted uniform distribution</b></span>
    <figure class="quote">
        <span class="curly-quotes">
            Let $(S, \mathcal{F}, \mu)$ be a measure space. For a disjoint family $\mathcal{A} = \left\{A_i\right\}_{i=1}^n \in \mathcal{F}$ of measurable sets with non-zero measure and a family $\mathbf{M} = \{M_i\}_{i=1}^n$ of non-negative real numbers (but $\sum_i M_i &gt; 0$), define the weighted uniform distribution on $S$ by
$$
\text{WUnif}(x|\mathbf{M}, \mathcal{A}) = \frac{1}{\sum_{j}M_j \cdot \mu(A_j)}\sum_i M_i ğŸ™_{A_i}(x)
$$
        </span>
    </figure>
</div>
<p>ì •ì˜ëŠ” ë­”ê°€ ë³µì¡í•´ ë³´ì´ì§€ë§Œ, ì´ë¥¼ 1ì°¨ì› êµ¬ê°„ì— ëŒ€í•´ì„œ ì •ì˜í•˜ë©´ êµ‰ì¥íˆ ê°„ë‹¨í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>$S = [a,b]$</li>
<li>$\mathcal{A} = \left\{[x_{i-1},x_i)\right\}_{i=1}^n$ and $\Delta x_i \equiv x_i - x_{i-1}$</li>
<li>$\displaystyle \text{WUnif}(x|\mathbf{M}, \mathcal{A}) = \frac{1}{\sum_{j}M_j \cdot \Delta x_j}\sum_i M_i ğŸ™_{A_i}(x)$</li>
</ul>
<p>ì—¬ê¸°ì„œëŠ” ì–´ì°¨í”¼ ì €í¬ê°€ ì‚¬ìš©í•  ë¶„í¬ê°€ 1ì°¨ì› ë¶„í¬ì´ë¯€ë¡œ ì•ìœ¼ë¡œ ì´ ì •ì˜ë¥¼ ì´ìš©í•˜ì—¬ ê³„ì‚°ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤. ì¼ë‹¨, ì´ í•¨ìˆ˜ê°€ í™•ë¥ ë°€ë„í•¨ìˆ˜ì„ì€ ê°„ë‹¨íˆ ì¦ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<blockquote>
<p>$$
\begin{aligned}
\int_a^b \text{WUnif}(x|\mathbf{M}, \mathcal{A}) dx &amp;= \int_a^b \frac{1}{\sum_{j}M_j \cdot \Delta x_j}\sum_i M_i ğŸ™_{A_i}(x) dx \\
&amp;= \frac{1}{\sum_{j}M_j \cdot \Delta x_j}\sum_i M_i \int_{a}^{b} ğŸ™_{A_i}(x) dx \\
&amp;= \frac{1}{\sum_{j}M_j \cdot \Delta x_j}\sum_i M_i \cdot \Delta x_i \\
&amp;= 1
\end{aligned}
$$</p>
</blockquote>
<p>Weighted uniform distributionì€ samplingí•˜ê¸°ë„ ì‰½ìŠµë‹ˆë‹¤. sampling ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<ol>
<li>
<p>ì „ì²´ $n$ê°œì˜ êµ¬ê°„ ì¤‘ì—ì„œ í•œ êµ¬ê°„ì„ ë½‘ìŠµë‹ˆë‹¤. ì´ë•Œ ê° êµ¬ê°„ì˜ í™•ë¥ ì€ $\displaystyle \frac{M_i \cdot \Delta x_i}{\sum_{j}M_j \cdot \Delta x_j}$ì…ë‹ˆë‹¤.</p>
</li>
<li>
<p>ê° êµ¬ê°„ì€ Uniform distributionì„ ë”°ë¥´ë¯€ë¡œ, êµ¬ê°„ ë‚´ì—ì„œ Uniform distributionìœ¼ë¡œ í•˜ë‚˜ì˜ ìƒ˜í”Œì„ ë½‘ìŠµë‹ˆë‹¤.</p>
</li>
</ol>
<p>ë§Œì¼ max-poolingì„ ì ìš©í•˜ì—¬ $\mathbf{M}, \mathcal{A}$ë¥¼ ê³¨ëë‹¤ë©´, ê° êµ¬ê°„ì˜ ê¸¸ì´ê°€ ëª¨ë‘ ë™ì¼í•˜ë¯€ë¡œ í™•ë¥ ì—ì„œ êµ¬ê°„ì˜ ê¸¸ì´ í•­ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ê²½ìš°ì— ê° êµ¬ê°„ì˜ í™•ë¥ ì€ $M_i / \sum_{j}M_j$ê°€ ë˜ì–´ êµ‰ì¥íˆ ê°„ë‹¨í•´ì§‘ë‹ˆë‹¤.</p>
<h3 id="23-piecewise-rejection-sampling">2.3. Piecewise Rejection Sampling</h3>
<p>â€ƒâ€ƒWeighted uniform distributionë„ samplingë°©ë²•ì„ ì•Œê³  ìˆëŠ” ì—„ì—°í•œ í•˜ë‚˜ì˜ í™•ë¥ ë¶„í¬ì´ë¯€ë¡œ, ì´ë¥¼ Rejection samplingì—ì„œì˜ $g(x)$ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, í•­ìƒ $f(x)$ë³´ë‹¤ ì»¤ì•¼ëœë‹¤ëŠ” ì¡°ê±´ì„ ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•˜ì—¬ ì„ì˜ì˜ $\mathbf{M}, \mathcal{A}$ë¥¼ ê³ ë¥´ëŠ” ê²ƒì´ ì•„ë‹Œ max-poolingì„ ì ìš©í•˜ì—¬ $\mathbf{M}, \mathcal{A}$ë¥¼ ì–»ì„ ê²ƒì…ë‹ˆë‹¤. ì´ ê³¼ì •ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<ol>
<li>
<p>ì „ì²´ êµ¬ê°„ì„ ëª‡ ê°œì˜ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆŒì§€ ê²°ì •í•©ë‹ˆë‹¤. ì´ë•Œ, êµ¬ê°„ì˜ ê°œìˆ˜ë¥¼ $n$ì´ë¼ê³  í•˜ê³  ê° êµ¬ê°„ì˜ ê¸¸ì´ë¥¼ ë™ë“±í•˜ê²Œ ë‚˜ëˆ„ì–´ $\mathcal{A}$ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p>ë‚˜ëˆ ì§„ êµ¬ê°„ì— ëŒ€í•´ $f(x)$ë¥¼ max-poolingí•˜ì—¬ $\mathbf{M}$ì„ ì–»ìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p>$\mathbf{M}, \mathcal{A}$ë¥¼ ì´ìš©í•˜ì—¬ Weighted uniform distributionì„ ì •ì˜í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p>ì´ë ‡ê²Œ ì •ì˜ëœ Weighted uniform distributionì„ Rejection samplingì—ì„œì˜ $g(x)$ë¡œ ì‚¬ìš©í•˜ì—¬ samplingí•©ë‹ˆë‹¤.</p>
</li>
</ol>
<p>ì´ëŸ¬í•œ sampling ë°©ë²•ì€ ë§ˆì¹˜ êµ¬ê°„ì„ ë‚˜ëˆ„ì–´ samplingí•˜ëŠ” ê²ƒê³¼ ê°™ìœ¼ë¯€ë¡œ <span style="background-color: rgba(255, 255, 0, 0.534);">
    <b>Piecewise Rejection Sampling</b>
</span>ìœ¼ë¡œ ëª…ëª…í•˜ê² ìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì—ì„œì˜ Acceptance rateë¥¼ êµ¬í•´ë³´ë©´ ë‹¨ìˆœíˆ Uniform distributionì„ ì‚¬ìš©í•˜ì—¬ Rejection samplingì„ í•  ë•Œì— ë¹„í•´ Acceptance rateê°€ ë†’ì•„ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<blockquote>
<p>$$
\begin{aligned}
P(U &lt; f(Y)) &amp;= \int_a^b P(U &lt; f(Y) | Y = y) \cdot g(y) \, dy \\
&amp;= \int_a^b P(U &lt; f(y)) \cdot \text{WUnif}(y|\mathbf{M}, \mathcal{A}) \, dy \\
&amp;= \frac{1}{\sum_{j}M_j \cdot \Delta x_j} \sum_i M_i \int_{A_i} P(U &lt; f(y)) dy
\end{aligned}
$$
$U \sim \text{Unif}(u|0, M_i)$ì´ê³ , $P(U &lt; f(y)) = f(y)/{M_i}$ì´ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
$$
\begin{aligned}
P(U &lt; f(Y)) &amp;= \frac{1}{\sum_{j}M_j \cdot \Delta x_j} \sum_i \int_{A_i} f(y)\, dy \\
&amp;= \frac{1}{\sum_{j}M_j \cdot \Delta x_j} \geq \frac{1}{M_\max \cdot \sum_{j} \Delta x_j}  = \frac{1}{M}
\end{aligned}
$$</p>
</blockquote>
<p>ë§ˆì§€ë§‰ ë¶€ë“±ì‹ì€ $M_i$ ì¤‘ì—ì„œ ê°€ì¥ í° ê°’ì— ì „ì²´ êµ¬ê°„ì˜ ê¸¸ì´ë¥¼ ê³±í•˜ë©´ ì›ë˜ Uniform distributionì„ ì‚¬ìš©í•  ë•Œì˜ $M$ê³¼ ê°™ë‹¤ëŠ” ê²ƒì„ ì´ìš©í•˜ì—¬ ì •ë¦¬í•œ ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ Piecewise rejection samplingì˜ Acceptance rateëŠ” Uniform distributionì„ ì‚¬ìš©í•  ë•Œì˜ Acceptance rateë³´ë‹¤ í•­ìƒ ë†’ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ ì²˜ìŒì— ì œì‹œí–ˆë˜ ë¬¸ì œë¥¼ Piecewise rejection samplingì„ ì´ìš©í•˜ì—¬ í’€ì–´ë³´ê² ìŠµë‹ˆë‹¤. ìœ„ ì•Œê³ ë¦¬ì¦˜ì€ Rust numeric libraryì¸ <a href="https://github.com/Axect/Peroxide">Peroxide</a>ì— ì´ë¯¸ êµ¬í˜„ì´ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ì´ìš©í•˜ê² ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">// Before running this code, you need to add peroxide in Cargo.toml
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// `cargo add peroxide --features parquet`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">use</span> peroxide::fuga::<span style="color:#f92672">*</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[allow(non_snake_case)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Read parquet data file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> df <span style="color:#f92672">=</span> DataFrame::read_parquet(<span style="color:#e6db74">&#34;data/test.parquet&#34;</span>).unwrap();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> E: Vec<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">f64</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;E&#34;</span>].to_vec();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> dNdE: Vec<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">f64</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;dNdE&#34;</span>].to_vec();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Cubic hermite spline -&gt; Make continuous f(x)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> cs <span style="color:#f92672">=</span> cubic_hermite_spline(<span style="color:#f92672">&amp;</span>E, <span style="color:#f92672">&amp;</span>dNdE, Quadratic);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> f <span style="color:#f92672">=</span> <span style="color:#f92672">|</span>x: <span style="color:#66d9ef">f64</span><span style="color:#f92672">|</span> cs.eval(x);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Piecewise rejection sampling
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// * # samples = 10000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// * # bins = 100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// * tolerance = 1e-6
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> E_sample <span style="color:#f92672">=</span> prs(f, <span style="color:#ae81ff">10000</span>, (E[<span style="color:#ae81ff">0</span>], E[E.len()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]), <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">1e-6</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Write parquet data file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> df <span style="color:#f92672">=</span> DataFrame::new(vec![]);
</span></span><span style="display:flex;"><span>    df.push(<span style="color:#e6db74">&#34;E&#34;</span>, Series::new(E_sample));
</span></span><span style="display:flex;"><span>    df.write_parquet(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;data/prs.parquet&#34;</span>, 
</span></span><span style="display:flex;"><span>        CompressionOptions::Uncompressed
</span></span><span style="display:flex;"><span>    ).unwrap();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ë°ì´í„°ë¥¼ íˆìŠ¤í† ê·¸ë¨ìœ¼ë¡œ ê·¸ë ¤ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<figure>
    <img src="https://axect.github.io/posts/images/006_05_hist.png"
         alt="Finally, we get samples!"/> <figcaption style="text-align:center">
            <p>Finally, we get samples!</p>
        </figcaption>
</figure>
<hr>
<h2 id="references">References</h2>
<ul>
<li>
<p><strong>Yen-Chi Chen</strong>, <em>Lecture 4: Importance Sampling and Rejection Sampling</em>, STAT/Q SCI 403: Introduction to Resampling Methods (2017)</p>
</li>
<li>
<p><strong>Ovidiu Calin</strong>, <em>Deep Learning Architectures: A Mathematical Approach</em>, Springer (2020)</p>
</li>
<li>
<p><strong>Tae-Geun Kim (<a href="https://github.com/Axect">Axect</a>)</strong>, <a href="https://axect.github.io/ML_with_Rust"><em>Precise Machine Learning with Rust</em></a> (2019)</p>
</li>
</ul>
<hr>
<h2 id="footnotes">A. Footnotes</h2>
<p>[1]: ì—¬ê¸°ì— ì‚¬ìš©ëœ ê·¸ë¦¼ì€ ì›ì‹œë¸”ë™í™€(Primordial Black hole; PBH)ë¡œë¶€í„° íŠ¹ì •ì‹œê°„ì— ë°©ì¶œëœ ì•¡ì‹œì˜¨ìœ ì‚¬ì…ìë“¤(Axion Like Particles; ALPs)ì˜ ìŠ¤í™íŠ¸ëŸ¼ì„ ê·¸ë¦° ê·¸ë¦¼ì…ë‹ˆë‹¤. ì´ ì—°êµ¬ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://arxiv.org/abs/2212.11977">arXiv:2212.11977</a>ì„ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p>[2]: ë¬¼ë¡  ì´ ê²½ìš°ì—ë„, ë…¸ë“œë“¤ì„ cubic spline ë“±ì˜ ë°©ë²•ìœ¼ë¡œ ê·¼ì‚¬í•˜ê³  ìˆ˜ì¹˜ì ë¶„ì´ë‚˜ polynomial ì ë¶„ì„ ì´ìš©í•˜ì—¬ ëˆ„ì ë¶„í¬í•¨ìˆ˜ë¥¼ êµ¬í•œ í›„, ì´ë¥¼ ë‹¤ì‹œ interpolationì´ë‚˜ splineë“±ì˜ ë°©ë²•ìœ¼ë¡œ fittingí•œ í›„ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê¸´í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŠ” ì˜¤ì°¨ê°€ ê½¤ ì‹¬í•˜ê³  ë¹„íš¨ìœ¨ì ì´ë¼ ì¶”ì²œí•˜ì§„ ì•ŠìŠµë‹ˆë‹¤.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://axect.github.io/tags/statistics/">statistics</a></span>
        <span class="tag"><a href="https://axect.github.io/tags/piecewise-rejection-sampling/">piecewise rejection sampling</a></span>
        
    </p>


      


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1877 ë‹¨ì–´
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-11-18 17:49 &#43;0900
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        <style>
  .resp-sharing-button__link {
    display: inline-block;  
    margin-right: 10px;  
  }
   
  .resp-sharing-button__link:last-child {
    margin-right: 0;
  }
</style>


<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling&amp;caption=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling&amp;canonicalUrl=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling&amp;body=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f&amp;title=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling&amp;summary=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling&amp;source=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f&amp;resubmit=true&amp;title=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling%20https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f&amp;t=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=%f0%9f%93%8a%20Piecewise%20Rejection%20Sampling&amp;url=https%3a%2f%2faxect.github.io%2fposts%2f006_prs%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        
        <div class="pagination__title">
            <span class="pagination__title-h">ë‹¤ë¥¸ ê¸€ ì½ê¸°</span>
            <hr />
        </div>
        

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="https://axect.github.io/posts/005_decov/">
                    <span class="button__text">ğŸ’” Decorrelation &#43; Deep learning = Generalization</span>
                    <span class="button__icon">â†’</span>
                </a>
            </span>
            
        </div>
    </div>



    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            <span><a href="https://axect.github.io">Axect</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://axect.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        




<script type="text/javascript" src="https://axect.github.io/bundle.min.8cc3758efe48ef82e2eb9a5f317b44c0805353a43762207be6fe8ffb05815cce7a19d37f6bf387c378a3bdfc3029981668d645374a33db4ee3480e15a4bfdc7c.js" integrity="sha512-jMN1jv5I74Li65pfMXtEwIBTU6Q3YiB75v6P&#43;wWBXM56GdN/a/OHw3ijvfwwKZgWaNZFN0oz207jSA4VpL/cfA=="></script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-167590700-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



    </body>
</html>
